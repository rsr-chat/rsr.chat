"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[1122],{2218(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"proto/extensions/extended-message-length","title":"rsr.chat/extended-line-length","description":"This specification is still a draft and is subject to change at any time.","source":"@site/docs/proto/1500_extensions/extended-message-length.md","sourceDirName":"proto/1500_extensions","slug":"/proto/extensions/extended-message-length","permalink":"/docs/proto/extensions/extended-message-length","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"rsr.chat/extended-line-length"},"sidebar":"protoSidebar","previous":{"title":"rsr.chat/emote","permalink":"/docs/proto/extensions/emote"},"next":{"title":"rsr.chat/message-link","permalink":"/docs/proto/extensions/message-link"}}');var i=t(4848),r=t(8453);const a={title:"rsr.chat/extended-line-length"},o="rsr.chat/extended-line-length",l={},d=[{value:"Motivation",id:"motivation",level:2},{value:"Capability",id:"capability",level:2},{value:"ISUPPORT Token",id:"isupport-token",level:2},{value:"Client Behaviour",id:"client-behaviour",level:2},{value:"Server Behaviour",id:"server-behaviour",level:2},{value:"Server-to-Server Considerations",id:"server-to-server-considerations",level:2},{value:"Examples",id:"examples",level:2},{value:"Successful negotiation and use",id:"successful-negotiation-and-use",level:3},{value:"Oversized message rejected",id:"oversized-message-rejected",level:3},{value:"Client without capability sends oversized message",id:"client-without-capability-sends-oversized-message",level:3}];function c(e){const n={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsxs)(n.p,{children:["This specification is still a ",(0,i.jsx)(n.strong,{children:"draft"})," and is subject to change at any time."]})}),"\n",(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"rsrchatextended-line-length",children:"rsr.chat/extended-line-length"})}),"\n",(0,i.jsx)(n.p,{children:"This extension allows servers to advertise support for IRC message lines longer than the\n512-byte limit defined in RFC 1459, and for clients to opt in to sending and receiving them."}),"\n",(0,i.jsx)(n.h2,{id:"motivation",children:"Motivation"}),"\n",(0,i.jsx)(n.p,{children:"RFC 1459 limits IRC messages to 512 bytes including the trailing CRLF. This constrains\nmodern use cases such as long-form messaging, rich metadata in message tags, and encoded\ncontent. This extension provides a negotiated, interoperable mechanism for raising that limit."}),"\n",(0,i.jsx)(n.h2,{id:"capability",children:"Capability"}),"\n",(0,i.jsxs)(n.p,{children:["This extension is advertised as the ",(0,i.jsx)(n.code,{children:"rsr.chat/extended-line-length"})," capability during CAP\nnegotiation. The capability MUST carry a value indicating the maximum total line length in\nbytes, including the leading colon (if present), all parameters, and the trailing CRLF:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"CAP * LS :rsr.chat/extended-line-length=8192\n"})}),"\n",(0,i.jsx)(n.p,{children:"The capability value is authoritative. Clients MUST use this value to determine the\nmaximum permitted line length and MUST NOT rely solely on the ISUPPORT token (see below)."}),"\n",(0,i.jsx)(n.h2,{id:"isupport-token",children:"ISUPPORT Token"}),"\n",(0,i.jsxs)(n.p,{children:["For compatibility with clients that do not perform CAP negotiation, servers MUST also\nadvertise the limit via the ",(0,i.jsx)(n.code,{children:"LINELEN"})," token in ",(0,i.jsx)(n.code,{children:"RPL_ISUPPORT"})," (005), sent after registration:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:":server 005 nick LINELEN=8192 :are supported by this server\n"})}),"\n",(0,i.jsxs)(n.p,{children:["If the server's limit changes (e.g. after a configuration reload), a fresh ",(0,i.jsx)(n.code,{children:"RPL_ISUPPORT"}),"\nMUST be sent to all connected clients reflecting the updated value."]}),"\n",(0,i.jsx)(n.h2,{id:"client-behaviour",children:"Client Behaviour"}),"\n",(0,i.jsx)(n.p,{children:"Clients that negotiate this capability MAY send messages up to the advertised byte length."}),"\n",(0,i.jsx)(n.p,{children:"Clients that do not negotiate this capability MUST NOT send messages exceeding 512 bytes,\nand servers MUST treat them as if this extension is not in effect."}),"\n",(0,i.jsx)(n.h2,{id:"server-behaviour",children:"Server Behaviour"}),"\n",(0,i.jsxs)(n.p,{children:["If a client that has negotiated this capability sends a message exceeding the advertised\nlimit, the server MUST reply with ",(0,i.jsx)(n.code,{children:"ERR_INPUTTOOLONG"})," (417) and MUST NOT relay or process\nthe message:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:":server 417 nick :Input line was too long\n"})}),"\n",(0,i.jsxs)(n.p,{children:["If a client that has ",(0,i.jsx)(n.em,{children:"not"})," negotiated this capability sends a message exceeding 512 bytes,\nthe server MUST also reply with ",(0,i.jsx)(n.code,{children:"ERR_INPUTTOOLONG"})," (417) and MUST NOT relay the message."]}),"\n",(0,i.jsx)(n.p,{children:"Servers MUST NOT silently truncate messages under any circumstance."}),"\n",(0,i.jsx)(n.h2,{id:"server-to-server-considerations",children:"Server-to-Server Considerations"}),"\n",(0,i.jsx)(n.p,{children:"This extension governs client-to-server line length only. Servers relaying messages to\nother servers MUST NOT assume that the remote server supports extended line lengths unless\nnegotiated via a separate server-to-server protocol mechanism. Servers SHOULD truncate or\nreject outbound messages that exceed the remote server's known or assumed limit and log a\nwarning when doing so."}),"\n",(0,i.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsx)(n.h3,{id:"successful-negotiation-and-use",children:"Successful negotiation and use"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"C: CAP LS 302\nS: CAP * LS :rsr.chat/extended-line-length=8192\nC: CAP REQ :rsr.chat/extended-line-length\nS: CAP * ACK :rsr.chat/extended-line-length\nC: NICK alice\nC: USER alice 0 * :Alice\nS: 005 alice LINELEN=8192 :are supported by this server\nS: 001 alice :Welcome to the network\n\nC: PRIVMSG #channel :[4000-byte message body...]\nS: (message relayed to channel members that have also negotiated the capability)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"oversized-message-rejected",children:"Oversized message rejected"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"C: PRIVMSG #channel :[message exceeding 8192 bytes...]\nS: :server 417 alice :Input line was too long\n"})}),"\n",(0,i.jsx)(n.h3,{id:"client-without-capability-sends-oversized-message",children:"Client without capability sends oversized message"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"C: PRIVMSG #channel :[600-byte message, capability not negotiated]\nS: :server 417 alice :Input line was too long\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453(e,n,t){t.d(n,{R:()=>a,x:()=>o});var s=t(6540);const i={},r=s.createContext(i);function a(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);